# Worktrunk Global Configuration
# Copy to: ~/.config/worktrunk/config.toml (or use `wt config create`)
#
# Alternative locations (XDG Base Directory spec):
#   macOS/Linux:   $XDG_CONFIG_HOME/worktrunk/config.toml
#   Windows:       %APPDATA%\worktrunk\config.toml

# Commit Message Generation (Optional)
# For generating commit messages during merge operations (wt merge)
[commit-generation]
# Example: Simon Willison's llm CLI (https://github.com/simonw/llm)
# Install: pip install llm llm-anthropic
command = "llm"
args = ["-m", "claude-haiku-4.5"]

# Alternative: AIChat - Rust-based, supports 20+ providers
# Install from: https://github.com/sigoden/aichat
# command = "aichat"
# args = ["-m", "claude:claude-haiku-4.5"]

# Optional: Load template from file (mutually exclusive with 'template')
# Supports ~ expansion: ~/.config/worktrunk/commit-template.txt
# template-file = "~/.config/worktrunk/commit-template.txt"

# Optional: Load squash template from file (mutually exclusive with 'squash-template')
# Supports ~ expansion: ~/.config/worktrunk/squash-template.txt
# squash-template-file = "~/.config/worktrunk/squash-template.txt"

# See "Custom Prompt Templates" section at end of file for inline template options.

# Worktree Path Template
# Variables:
#   {{ main_worktree }} - Main worktree directory name (e.g., "myproject")
#   {{ branch }}        - Branch name with slashes replaced by dashes (feature/auth → feature-auth)
#
# Paths are relative to the main worktree root (original repository directory).
#
# Example paths created (main worktree at /Users/dev/myproject, branch feature/auth):
#   "../{{ main_worktree }}.{{ branch }}" → /Users/dev/myproject.feature-auth
#   ".worktrees/{{ branch }}"             → /Users/dev/myproject/.worktrees/feature-auth
worktree-path = "../{{ main_worktree }}.{{ branch }}"

# Alternative: Inside repo (useful for bare repos)
# worktree-path = ".worktrees/{{ branch }}"

# List Command Defaults
# Configure default behavior for `wt list`
[list]
full = false       # Show CI, conflicts, diffs by default
branches = false   # Include branches without worktrees by default
remotes = false    # Include remote branches by default

# Commit Defaults (shared by `wt step commit`, `wt step squash`, and `wt merge`)
[commit]
stage = "all"          # What to stage: "all", "tracked", or "none"

# Merge Command Defaults
# Note: `stage` defaults from [commit] section above
[merge]
squash = true          # Squash commits when merging
commit = true          # Commit, squash, and rebase during merge
remove = true          # Remove worktree after merge
verify = true          # Run project hooks

# Approved Commands
# Commands approved for automatic execution after switching worktrees
# Auto-populated when you use: wt switch --execute "command" --force
[projects."github.com/user/repo"]
approved-commands = ["npm install"]

# NOTE: For project-specific hooks (post-create, post-start, pre-merge, etc.),
# use a separate PROJECT config file at <repo>/.config/wt.toml
# See: dev/wt.example.toml for project configuration examples

# ============================================================================
# Custom Prompt Templates (Advanced)
# ============================================================================
# These options belong under [commit-generation] section above.
# NOTE: Templates are synced from src/llm.rs by `cargo test readme_sync`

# Optional: Custom prompt template (inline) - Uses minijinja syntax
# Available variables: {{ git_diff }}, {{ branch }}, {{ recent_commits }}, {{ repo }}
# If not specified, uses the default template shown below:
# <!-- DEFAULT_TEMPLATE_START -->
# template = """
# Format
# - First line: <50 chars, present tense, describes WHAT and WHY (not HOW).
# - Blank line after first line.
# - Optional details with proper line breaks explaining context. Commits with more substantial changes should have more details.
# - Return ONLY the formatted message without quotes, code blocks, or preamble.
#
# Style
# - Do not give normative statements or otherwise speculate on why the change was made.
# - Broadly match the style of the previous commit messages.
#   - For example, if they're in conventional commit format, use conventional commits; if they're not, don't use conventional commits.
#
# The context contains:
# - <git-diff> with the staged changes. This is the ONLY content you should base your message on.
# - <git-info> with branch name and recent commit message titles for style reference ONLY. DO NOT use their content to inform your message.
#
# ---
# The following is the context for your task:
# ---
# <git-diff>
# ```
# {{ git_diff }}
# ```
# </git-diff>
#
# <git-info>
#   <current-branch>{{ branch }}</current-branch>
# {% if recent_commits %}
#   <previous-commit-message-titles>
# {% for commit in recent_commits %}
#     <previous-commit-message-title>{{ commit }}</previous-commit-message-title>
# {% endfor %}
#   </previous-commit-message-titles>
# {% endif %}
# </git-info>
# """
# <!-- DEFAULT_TEMPLATE_END -->
#
# Example alternative template with different style:
# template = """
# Generate a commit message for {{ repo | upper }}.
#
# Branch: {{ branch }}
# {%- if recent_commits %}
#
# Recent commit style ({{ recent_commits | length }} commits):
# {%- for commit in recent_commits %}
#   {{ loop.index }}. {{ commit }}
# {%- endfor %}
# {%- endif %}
#
# Changes to commit:
# ```
# {{ git_diff }}
# ```
#
# Requirements:
# - Follow the style of recent commits above
# - First line under 50 chars
# - Focus on WHY, not HOW
# """

# Optional: Custom squash commit message template (inline) - Uses minijinja syntax
# Available variables: {{ commits }}, {{ target_branch }}, {{ branch }}, {{ repo }}
# If not specified, uses the default template:
# <!-- DEFAULT_SQUASH_TEMPLATE_START -->
# squash-template = """
# Generate a commit message that combines these changes into one cohesive message. Output only the commit message without any explanation.
#
# Format
# - First line: <50 chars, present tense, describes WHAT and WHY (not HOW).
# - Blank line after first line.
# - Optional details with proper line breaks explaining context.
# - Match the style of the existing commits being squashed (e.g., if they use conventional commits, use conventional commits).
#
# Squashing commits from {{ branch }} to merge into {{ target_branch }}
#
# Commits being combined:
# {% for commit in commits %}
# - {{ commit }}
# {% endfor %}
# """
# <!-- DEFAULT_SQUASH_TEMPLATE_END -->
#
# Example alternative template:
# squash-template = """
# Squashing {{ commits | length }} commit(s) from {{ branch }} to {{ target_branch }}.
#
# {% if commits | length > 1 -%}
# Commits being combined:
# {%- for c in commits %}
#   {{ loop.index }}/{{ loop.length }}: {{ c }}
# {%- endfor %}
# {%- else -%}
# Single commit: {{ commits[0] }}
# {%- endif %}
#
# Generate one cohesive commit message that captures the overall change.
# Use conventional commit format (feat/fix/docs/refactor).
# """
