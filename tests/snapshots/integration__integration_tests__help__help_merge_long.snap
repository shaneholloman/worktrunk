---
source: tests/integration_tests/help.rs
info:
  program: wt
  args:
    - merge
    - "--help"
  env:
    CLICOLOR_FORCE: "1"
    COLUMNS: "500"
    LANG: C
    LC_ALL: C
    PSModulePath: ""
    RUST_LOG: warn
    SHELL: ""
    TERM: alacritty
    WORKTRUNK_CONFIG_PATH: /nonexistent/test/config.toml
    WORKTRUNK_TEST_CLAUDE_INSTALLED: "0"
    WORKTRUNK_TEST_POWERSHELL_ENV: "0"
    WORKTRUNK_TEST_SKIP_URL_HEALTH_CHECK: "1"
    WT_TEST_DELAYED_STREAM_MS: "-1"
    WT_TEST_EPOCH: "1735776000"
---
success: true
exit_code: 0
----- stdout -----

----- stderr -----
wt merge - Merge current branch into target[0m

Squash & rebase, fast-forward target, remove the worktree.[0m

Usage: [1m[36mwt merge[0m [36m[OPTIONS][0m [36m[TARGET][0m

[1m[32mArguments:[0m
  [36m[TARGET][0m
          Target branch[0m
          
          Defaults to default branch.[0m

[1m[32mOptions:[0m
      [1m[36m--no-squash[0m
          Skip commit squashing

      [1m[36m--no-commit[0m
          Skip commit and squash

      [1m[36m--no-rebase[0m
          Skip rebase (fail if not already rebased)

      [1m[36m--no-remove[0m
          Keep worktree after merge

      [1m[36m--no-verify[0m
          Skip hooks

  [1m[36m-y[0m, [1m[36m--yes[0m
          Skip approval prompts

      [1m[36m--stage[0m[36m [0m[36m<STAGE>[0m
          What to stage before committing [default: all]

          Possible values:
          - [1m[36mall[0m:     Stage everything: untracked files + unstaged tracked changes
          - [1m[36mtracked[0m: Stage tracked changes only (like [1mgit add -u[0m)
          - [1m[36mnone[0m:    Stage nothing, commit only what's already in the index

  [1m[36m-h[0m, [1m[36m--help[0m
          Print help (see a summary with '-h')

[1m[32mGlobal Options:[0m
  [1m[36m-C[0m[36m [0m[36m<path>[0m
          Working directory for this command

      [1m[36m--config[0m[36m [0m[36m<path>[0m
          User config file path

  [1m[36m-v[0m, [1m[36m--verbose[0m[36m...[0m
          Verbose output (-v: hooks, templates; -vv: debug report)

Unlike [2mgit merge[0m, this merges current into target (not target into current). Similar to clicking "Merge pull request" on GitHub, but locally. Target defaults to the default branch.

[1m[32mExamples[0m

Merge to the default branch:

  [2mwt merge[0m

Merge to a different branch:

  [2mwt merge develop[0m

Keep the worktree after merging:

  [2mwt merge --no-remove[0m

Preserve commit history (no squash):

  [2mwt merge --no-squash[0m

Skip committing/squashing (rebase still runs unless --no-rebase):

  [2mwt merge --no-commit[0m

[1m[32mPipeline[0m

[2mwt merge[0m runs these steps:

1. [1mSquash[0m â€” Stages uncommitted changes, then combines all commits since target into one (like GitHub's "Squash and merge"). Use [2m--stage[0m to control what gets staged: [2mall[0m (default), [2mtracked[0m, or [2mnone[0m. A backup ref is saved to [2mrefs/wt-backup/<branch>[0m. With [2m--no-squash[0m, uncommitted changes become a separate commit and individual commits are preserved.
2. [1mRebase[0m â€” Rebases onto target if behind. Skipped if already up-to-date. Conflicts abort immediately.
3. [1mPre-merge hooks[0m â€” Hooks run after rebase, before merge. Failures abort. See [2mwt hook[0m.
4. [1mMerge[0m â€” Fast-forward merge to the target branch. Non-fast-forward merges are rejected.
5. [1mPre-remove hooks[0m â€” Hooks run before removing worktree. Failures abort.
6. [1mCleanup[0m â€” Removes the worktree and branch. Use [2m--no-remove[0m to keep the worktree. When already on the target branch or in the main worktree, the worktree is preserved.
7. [1mPost-merge hooks[0m â€” Hooks run after cleanup. Failures are logged but don't abort.

Use [2m--no-commit[0m to skip committing uncommitted changes and squashing; rebase still runs by default and can rewrite commits unless [2m--no-rebase[0m is passed. Useful after preparing commits manually with [2mwt step[0m. Requires a clean working tree.

[1m[32mLocal CI[0m

For personal projects, pre-merge hooks open up the possibility of a workflow with much faster iteration â€” an order of magnitude more small changes instead of fewer large ones.

Historically, ensuring tests ran before merging was difficult to enforce locally. Remote CI was valuable for the process as much as the checks: it guaranteed validation happened. [2mwt merge[0m brings that guarantee local.

The full workflow: start an agent (one of many) on a task, work elsewhere, return when it's ready. Review the diff, run [2mwt merge[0m, move on. Pre-merge hooks validate before merging â€” if they pass, the branch goes to the default branch and the worktree cleans up.

  [2m[pre-merge][0m
  [2mtest = "cargo test"[0m
  [2mlint = "cargo clippy"[0m

[1m[32mSee also[0m

- [2mwt step[0m â€” Run individual operations (commit, squash, rebase, push)
- [2mwt remove[0m â€” Remove worktrees without merging
- [2mwt switch[0m â€” Navigate to other worktrees
